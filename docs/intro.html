<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lecture 1 Introduction | Assembly of ecological communities: some theoretical explorations</title>
  <meta name="description" content="Lecture notes prepared for the ICTP Winter School on Quantitative Systems Biology: Quantitative Approaches in Ecosystem Ecology." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Lecture 1 Introduction | Assembly of ecological communities: some theoretical explorations" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lecture notes prepared for the ICTP Winter School on Quantitative Systems Biology: Quantitative Approaches in Ecosystem Ecology." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lecture 1 Introduction | Assembly of ecological communities: some theoretical explorations" />
  
  <meta name="twitter:description" content="Lecture notes prepared for the ICTP Winter School on Quantitative Systems Biology: Quantitative Approaches in Ecosystem Ecology." />
  

<meta name="author" content="Stefano Allesina" />


<meta name="date" content="2020-12-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="top-down-assembly.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ICTP Winter School</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preliminaries</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#goals"><i class="fa fa-check"></i>Goals</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#computing"><i class="fa fa-check"></i>Computing</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#questions-and-answers"><i class="fa fa-check"></i>Questions and answers</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#generalized-lotka-volterra-model"><i class="fa fa-check"></i><b>1.1</b> Generalized Lotka-Volterra model</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#coexistence-equilibrium"><i class="fa fa-check"></i><b>1.1.1</b> Coexistence equilibrium</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#local-stability-of-the-coexistence-equilibrium"><i class="fa fa-check"></i><b>1.1.2</b> Local Stability of the coexistence equilibrium</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro.html"><a href="intro.html#the-equilibrium-is-the-time-average"><i class="fa fa-check"></i><b>1.1.3</b> The equilibrium is the time-average</a></li>
<li class="chapter" data-level="1.1.4" data-path="intro.html"><a href="intro.html#lyapunov-diagonal-stability-and-global-stability"><i class="fa fa-check"></i><b>1.1.4</b> Lyapunov diagonal stability and global stability</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#what-makes-the-study-of-assembly-difficult"><i class="fa fa-check"></i><b>1.2</b> What makes the study of assembly difficult?</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#ecological-assembly-without-tears"><i class="fa fa-check"></i><b>1.3</b> Ecological assembly without tears</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#top-down-and-bottom-up-assembly"><i class="fa fa-check"></i><b>1.4</b> Top-down and bottom-up assembly</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#modeling-invasions"><i class="fa fa-check"></i><b>1.5</b> Modeling invasions</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#invasions-in-multispecies-communities"><i class="fa fa-check"></i><b>1.6</b> Invasions in multispecies communities</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#lyapunov-stability-and-saturated-equilibria"><i class="fa fa-check"></i><b>1.7</b> Lyapunov stability and saturated equilibria</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="top-down-assembly.html"><a href="top-down-assembly.html"><i class="fa fa-check"></i><b>2</b> Top-down assembly</a><ul>
<li class="chapter" data-level="2.1" data-path="top-down-assembly.html"><a href="top-down-assembly.html#a-trivial-case"><i class="fa fa-check"></i><b>2.1</b> A trivial case</a></li>
<li class="chapter" data-level="2.2" data-path="top-down-assembly.html"><a href="top-down-assembly.html#simulating-final-composition"><i class="fa fa-check"></i><b>2.2</b> Simulating final composition</a></li>
<li class="chapter" data-level="2.3" data-path="top-down-assembly.html"><a href="top-down-assembly.html#a-random-zoo"><i class="fa fa-check"></i><b>2.3</b> A random zoo</a></li>
<li class="chapter" data-level="2.4" data-path="top-down-assembly.html"><a href="top-down-assembly.html#a-random-zoo-in-the-wild"><i class="fa fa-check"></i><b>2.4</b> A random zoo in the wild</a></li>
<li class="chapter" data-level="2.5" data-path="top-down-assembly.html"><a href="top-down-assembly.html#assembly-and-saturated-equilibrium"><i class="fa fa-check"></i><b>2.5</b> Assembly and saturated equilibrium</a></li>
<li class="chapter" data-level="2.6" data-path="top-down-assembly.html"><a href="top-down-assembly.html#network-spandrels"><i class="fa fa-check"></i><b>2.6</b> Network spandrels</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bottom-up-assembly.html"><a href="bottom-up-assembly.html"><i class="fa fa-check"></i><b>3</b> Bottom-up assembly</a><ul>
<li class="chapter" data-level="3.1" data-path="bottom-up-assembly.html"><a href="bottom-up-assembly.html#an-assembly-graph"><i class="fa fa-check"></i><b>3.1</b> An assembly graph</a><ul>
<li class="chapter" data-level="3.1.1" data-path="bottom-up-assembly.html"><a href="bottom-up-assembly.html#how-many-invasions"><i class="fa fa-check"></i><b>3.1.1</b> How many invasions?</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="bottom-up-assembly.html"><a href="bottom-up-assembly.html#properties-of-the-assembly-graph"><i class="fa fa-check"></i><b>3.2</b> Properties of the assembly graph</a></li>
<li class="chapter" data-level="3.3" data-path="bottom-up-assembly.html"><a href="bottom-up-assembly.html#assembly-graphs-for-glv"><i class="fa fa-check"></i><b>3.3</b> Assembly graphs for GLV</a></li>
<li class="chapter" data-level="3.4" data-path="bottom-up-assembly.html"><a href="bottom-up-assembly.html#relationship-with-lyapunov-functions"><i class="fa fa-check"></i><b>3.4</b> Relationship with Lyapunov functions</a></li>
<li class="chapter" data-level="3.5" data-path="bottom-up-assembly.html"><a href="bottom-up-assembly.html#how-many-assembly-endpoints"><i class="fa fa-check"></i><b>3.5</b> How many assembly endpoints?</a></li>
<li class="chapter" data-level="3.6" data-path="bottom-up-assembly.html"><a href="bottom-up-assembly.html#build-your-own-assembly-graph"><i class="fa fa-check"></i><b>3.6</b> Build your own assembly graph!</a></li>
<li class="chapter" data-level="3.7" data-path="bottom-up-assembly.html"><a href="bottom-up-assembly.html#conclusions"><i class="fa fa-check"></i><b>3.7</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="references-and-readings.html"><a href="references-and-readings.html"><i class="fa fa-check"></i><b>4</b> References and readings</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Assembly of ecological communities: some theoretical explorations</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intro" class="section level1">
<h1><span class="header-section-number">Lecture 1</span> Introduction</h1>
<p>We call <strong>ecological assembly</strong> the process by which <strong>ecological communities are built</strong> by the interplay of invasions (increasing community “richness”) and extinctions (decreasing it). The typical setting for an assembly model is one in which a large (possibly infinite) pool of species are available (e.g., in a “mainland”), and every so often individuals from the species’ pool enter a local habitat (island, patch, etc.), at which point they might either grow (invasion, establishment, etc.), or go extinct. In either case, the local community might respond to the invader—for example, the invader could send some of the local populations extinct, or shift the community from one state to another.</p>
<p>Historically, this type of island-mainland models (based on species) have been contrasted with “trait-environment” models, in which species’ traits, rather than identity are the focus of the dynamics. In such models, ideas such as “environmental filtering” (i.e., the pruning of species that cannot grow in the local environment) and “trait underdispersion” (i.e., the fact that the filtering imposed by the environment results in a convergence in traits) arise naturally. When thinking of communities of competitors (e.g., different species of plants), then we might think that species’ interactions will also play a role—because species need to be different enough to coexist, this would generate “trait overdispersion” (due to limiting similarity). For a very opinionated summary of 25 years of discussions on these themes (1975-2000), see <span class="citation">Weiher and Keddy (<a href="#ref-weiher2001ecological" role="doc-biblioref">2001</a>)</span> (but first read the review <span class="citation">Gotelli (<a href="#ref-gotelli1999communities" role="doc-biblioref">1999</a>)</span>, stating that the language and tone of the introduction is “an embarrassment to the discipline”).</p>
<p>The idea of assembly was first introduced in ecology by the pioneers of “succession”. For example, in 1899 Henry Chandler Cowles studied the vegetation development in the Indiana Dunes—sand dunes are first colonized by “pioneer” species of plants, which are then overgrown by different vegetation in older dunes. Because dunes are regularly disrupted by wind, one could make a “space-for-time” substitution and reconstruct the development of the vegetation as a “chronosequence”. Importantly, Cowles (and then Clements) held the view that succession would be a strongly ordered, “determinisitc” process by which communities tended to a certain “climax” state. In the 1920s, Henry Gleason challenged this view, advocating for a much greater role for chance.</p>
<p>Another important piece of the puzzle was provided by the work of Jared Diamond who, while studying avian assemblages in New Guinea, proposed that certain species assemblages would be “forbidden” (due to competition)—by observing several instances of assembly (in the different islands), one could guess the rules of the assembly game (<span class="citation">Diamond (<a href="#ref-diamond1975assembly" role="doc-biblioref">1975</a>)</span>). Diamond’s work sparked decades of intense debate, bringing a focus on the role of null models in ecology (are the observed patterns due to chance or necessity?), with especially cogent critiques brought forward by Simberloff, Connor and Gotelli (see for example <span class="citation">Gotelli and Graves (<a href="#ref-gotelli1996null" role="doc-biblioref">1996</a>)</span>).</p>
<p>In the early 2000s, the focus changed decisively and became centered on the difference between “neutrality” (i.e., where species distribution are driven by stochastic fluctuations, <span class="citation">Hubbell (<a href="#ref-hubbell2001unified" role="doc-biblioref">2001</a>)</span>) and “niche” (i.e., driven by species interactions—or rather their avoidance).</p>
<p>Finally, the budding field of “community phylogenetics” (<span class="citation">Cadotte and Davies (<a href="#ref-cadotte2016phylogenies" role="doc-biblioref">2016</a>)</span>) is centered on relating these concepts to data stemming from phylogenetic trees.</p>
<p>Here, we step back and reconsider basic models of ecological assembly in the style for example of <span class="citation">Drake (<a href="#ref-drake1991community" role="doc-biblioref">1991</a>)</span>, <span class="citation">Law and Morton (<a href="#ref-law1996permanence" role="doc-biblioref">1996</a>)</span>, and <span class="citation">Morton et al. (<a href="#ref-morton1996models" role="doc-biblioref">1996</a>)</span>.</p>
<div id="generalized-lotka-volterra-model" class="section level2">
<h2><span class="header-section-number">1.1</span> Generalized Lotka-Volterra model</h2>
<p>For our explorations, we will use what is arguably the simplest model for the dynamics of an ecological community, the Generalized Lotka-Volterra model.</p>
<p>We can write the Generalized Lotka-Volterra model in a compact form as:</p>
<p><span class="math display">\[
\dfrac{dx(t)}{dt} = D(x(t))(r + A x(t)) 
\]</span></p>
<p>where <span class="math inline">\(x(t)\)</span> is a (column) vector of length <span class="math inline">\(n\)</span> containing the densities of all populations <span class="math inline">\(1, \ldots, n\)</span> at time <span class="math inline">\(t\)</span>, <span class="math inline">\(r\)</span> is a vector of “intrinsic growth rates” (or death rates, when negative), measuring the growth (decline) of population <span class="math inline">\(i\)</span> when grown alone at low density, and <span class="math inline">\(A\)</span> is a <span class="math inline">\(n \times n\)</span> matrix of interaction coefficients. We use <span class="math inline">\(D(x)\)</span> to denote the diagonal matrix with <span class="math inline">\(x\)</span> on the diagonal.</p>
<p>For a single species, the model can yield only a limited number of outcomes—the species can grow exponentially, decay exponentially, or reach an equilibrium. When we include two or more species, we can observe cycles, and with three or more species we can find chaotic dynamics.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="intro.html#cb1-1"></a><span class="kw">source</span>(<span class="st">&quot;code/general_code.R&quot;</span>)</span>
<span id="cb1-2"><a href="intro.html#cb1-2"></a><span class="co"># load interesting parameters</span></span>
<span id="cb1-3"><a href="intro.html#cb1-3"></a><span class="kw">load</span>(<span class="st">&quot;code/four_spp_cycle.RData&quot;</span>)</span>
<span id="cb1-4"><a href="intro.html#cb1-4"></a>A &lt;-<span class="st"> </span>limit_cycle_4spp<span class="op">$</span>A</span>
<span id="cb1-5"><a href="intro.html#cb1-5"></a>r &lt;-<span class="st"> </span>limit_cycle_4spp<span class="op">$</span>r</span>
<span id="cb1-6"><a href="intro.html#cb1-6"></a><span class="kw">set.seed</span>(<span class="dv">1</span>) <span class="co"># for reproducibility</span></span>
<span id="cb1-7"><a href="intro.html#cb1-7"></a>dynamics &lt;-<span class="st"> </span><span class="kw">GLV_dynamics</span>(<span class="dt">A =</span> A, </span>
<span id="cb1-8"><a href="intro.html#cb1-8"></a>                         <span class="dt">r =</span> r,</span>
<span id="cb1-9"><a href="intro.html#cb1-9"></a>                         <span class="dt">maxtime =</span> <span class="dv">150</span>)</span>
<span id="cb1-10"><a href="intro.html#cb1-10"></a><span class="kw">show</span>(<span class="kw">plot_dynamics</span>(dynamics))</span></code></pre></div>
<p><img src="ICTP_Winter_School_files/figure-html/unnamed-chunk-2-1.png" width="480" style="display: block; margin: auto;" /></p>
<div id="coexistence-equilibrium" class="section level3">
<h3><span class="header-section-number">1.1.1</span> Coexistence equilibrium</h3>
<p>For any instance of the model, we can look for stationary points (equilibria). If the matrix <span class="math inline">\(A\)</span> is not singular, then we can look for a solution of <span class="math inline">\(r + Ax = 0\)</span> that has positive components (called a <strong>feasible equilibrium</strong>). <strong>If such point exists, it is unique</strong> and is the solution of <span class="math inline">\(Ax^\star = -r\)</span>, <span class="math inline">\(x^\star = -A^{-1}r\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="intro.html#cb2-1"></a><span class="co"># find feasible equilibrium for the example above</span></span>
<span id="cb2-2"><a href="intro.html#cb2-2"></a><span class="kw">solve</span>(A, <span class="op">-</span>r)</span></code></pre></div>
<p>[1] 1.8722239 1.5603128 2.4236325 0.4654487</p>
<p>Suppose that the GLV has no feasible equilibrium. Then all trajectories (if bounded; some could grow to infinity) reach the boundary of <span class="math inline">\(\mathbb R^n_{0+}\)</span>. Practically, this means that <strong>to ensure coexistence of all species, it is necessary to have an equilibrium in the interior <span class="math inline">\(\mathbb R^n_{+}\)</span></strong>. For a proof, see Theorem 5.2.1 in <span class="citation">Hofbauer and Sigmund (<a href="#ref-hofbauer1998evolutionary" role="doc-biblioref">1998</a>)</span>.</p>
</div>
<div id="local-stability-of-the-coexistence-equilibrium" class="section level3">
<h3><span class="header-section-number">1.1.2</span> Local Stability of the coexistence equilibrium</h3>
<p>Suppose that a feasible equilibrium <span class="math inline">\(x^\star\)</span> exists. For the GLV model, the Jacobian is easy to compute:</p>
<p><span class="math display">\[
J_{ij} = \frac{\partial f_i}{\partial x_j} = A_{ij} x_i
\]</span></p>
<p>and</p>
<p><span class="math display">\[
J_{ii} = \frac{\partial f_i}{\partial x_i} = r_i + \sum_j A_{ij} x_j + A_{ii} x_i
\]</span></p>
<p>At equilibrium <span class="math inline">\(r_i + \sum_j A_{ij} x_j = 0\)</span>, and therefore:</p>
<p><span class="math display">\[
M = \left. {J} \right|_{ {x}^\star} = D(x^\star)A
\]</span></p>
<p>If the eigenvalues of <span class="math inline">\(M\)</span> have all negative real part, then <span class="math inline">\(x^\star\)</span> is locally asymptotically stable.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="intro.html#cb3-1"></a><span class="co"># build the community matrix</span></span>
<span id="cb3-2"><a href="intro.html#cb3-2"></a>x_star &lt;-<span class="st"> </span><span class="kw">solve</span>(A, <span class="op">-</span>r)</span>
<span id="cb3-3"><a href="intro.html#cb3-3"></a>M &lt;-<span class="st"> </span><span class="kw">diag</span>(x_star) <span class="op">%*%</span><span class="st"> </span>A</span>
<span id="cb3-4"><a href="intro.html#cb3-4"></a><span class="kw">eigen</span>(M, <span class="dt">only.values =</span> <span class="ot">TRUE</span>)<span class="op">$</span>values <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-5"><a href="intro.html#cb3-5"></a><span class="st">  </span><span class="kw">round</span>(<span class="dv">2</span>)</span></code></pre></div>
<p>[1] -2.40+0.00i 0.37+2.06i 0.37-2.06i -0.61+0.00i</p>
</div>
<div id="the-equilibrium-is-the-time-average" class="section level3">
<h3><span class="header-section-number">1.1.3</span> The equilibrium is the time-average</h3>
<p>Suppose that <span class="math inline">\(x(t)\)</span> has a periodic orbit of period <span class="math inline">\(T\)</span> (i.e., we assume <span class="math inline">\(x(0) = x(T)\)</span>). Further, assume that the GLV has a feasible, interior equilibrium <span class="math inline">\(x^\star\)</span>. We want to calculate the average density for each species:</p>
<p><span class="math display">\[
\frac{1}{T} \int_0^T x(t) dt
\]</span></p>
<p>First, we assume that <span class="math inline">\(x(t) &gt; 0\)</span> and write the dynamics of its logarithm:</p>
<p><span class="math display">\[
\dfrac{d \log(x_i(t))}{dt} = \dfrac{1}{x_i(t)}\dfrac{d x_i(t)}{dt} = r_i + \sum_j A_{ij} x_j(t)
\]</span></p>
<p>In vector form:</p>
<p><span class="math display">\[
\dfrac{d \log x(t)}{d t} = r + A x(t)
\]</span></p>
<p>Compute the average on both sides:</p>
<p><span class="math display">\[
\frac{1}{T}\int_0^T \frac{d \log(x(t))}{dt} dt= \frac{1}{T}\int_0^T \left(r + Ax \right) dt
\]</span></p>
<p>yielding:</p>
<p><span class="math display">\[
\frac{1}{T}(\log(x(T)) - \log(x(0))) = 0 = r + A \left( \frac{1}{T} \int_0^T x(t) dt \right)
\]</span></p>
<p>Note that the l.h.s. is zero because <span class="math inline">\(x(0) = x(T)\)</span>. Multiplying by the matrix inverse and rearranging:</p>
<p><span class="math display">\[
-A^{-1} r = x^\star =  \frac{1}{T} \int_0^T x(t) dt 
\]</span></p>
<p>showing that <strong>the average density is</strong> in fact <strong>the equilibrium</strong>. With a similar argument, one can prove that if the trajectory stays in a compact space (i.e., in case of chaotic attractors), then long-time average is still <span class="math inline">\(x^\star\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="intro.html#cb4-1"></a>dynamics<span class="op">$</span>ts <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-2"><a href="intro.html#cb4-2"></a><span class="st">  </span><span class="kw">filter</span>(time <span class="op">&gt;</span><span class="st"> </span><span class="dv">50</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-3"><a href="intro.html#cb4-3"></a><span class="st">  </span><span class="kw">group_by</span>(species) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-4"><a href="intro.html#cb4-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">density =</span> <span class="kw">mean</span>(density)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-5"><a href="intro.html#cb4-5"></a><span class="st">  </span><span class="kw">select</span>(density) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">t</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.numeric</span>()</span></code></pre></div>
<p>[1] 1.8681154 1.5585202 2.4212556 0.4621904</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="intro.html#cb5-1"></a>x_star</span></code></pre></div>
<p>[1] 1.8722239 1.5603128 2.4236325 0.4654487</p>
</div>
<div id="lyapunov-diagonal-stability-and-global-stability" class="section level3">
<h3><span class="header-section-number">1.1.4</span> Lyapunov diagonal stability and global stability</h3>
<p>Suppose that there is a positive diagonal matrix <span class="math inline">\(C\)</span> such that <span class="math inline">\(C A + A^T C\)</span> is negative definite (i.e., has only negative eigenvalues; the eigenvalues are real because the matrix is symmetric). Then <span class="math inline">\(A\)</span> is <strong>Lyapunov-diagonally stable</strong>. If this is the case, then <span class="math inline">\(A\)</span> is stable, and any <span class="math inline">\(D A\)</span> with <span class="math inline">\(D\)</span> positive is also stable (called <span class="math inline">\(D-\)</span>stability).</p>
<p>Further, suppose that the GLV system with parameters <span class="math inline">\(A\)</span> and <span class="math inline">\(r\)</span> has a feasible equilibrium point <span class="math inline">\(x^\star\)</span>. Then the function:</p>
<p><span class="math display">\[
V(x(t)) = 1^T C \left( x(t) -x^\star -x^\star \cdot \log (x(t) / x^\star)\right)
\]</span></p>
<p>is a Lyapunov function for the GLV system. It is clear that <span class="math inline">\(V(x(t))\)</span> is positive everywhere in the positive orthant besides at equilibrium. Then, we need to show that the function decreases along the trajectories of the system (<span class="citation">Goh (<a href="#ref-goh1977global" role="doc-biblioref">1977</a>)</span>).</p>
<p>To prove this point, we start from <span class="math inline">\(r = -A x^\star\)</span>. Substituting, we can write the GLV system as <span class="math inline">\(dx(t)/dt = D(x)A(x - x^\star)\)</span>; similarly, we can write <span class="math inline">\(d \log x(t)/dt = A(x - x^\star)\)</span>. Taking the derivative of <span class="math inline">\(V\)</span> with respect to time:</p>
<p><span class="math display">\[
\begin{aligned}
 \frac{d V(x(t))}{dt} &amp;= 1^T C \left(\frac{d x(t)}{dt} - D(x^\star) \frac{d \log x(t)}{dt} \right)\\
 &amp;= 1^T C \left(D(x)(A (x - x^\star)  - D(x^\star) A (x - x^\star) \right)\\
 &amp;= 1^T C \left(D(x - x^\star)  A (x - x^\star) \right)\\
 &amp;= 1^T \left(D(x - x^\star)  C A (x - x^\star) \right)\\
 &amp;= (x - x^\star)^T  CA (x - x^\star)\\
 &amp;= \frac{1}{2}(x - x^\star)^T  (CA + A^T C) (x - x^\star)\\
\end{aligned}
\]</span></p>
<p>A matrix <span class="math inline">\(B\)</span> is negative definite if <span class="math inline">\(y^T B y &lt; 0\)</span> for all <span class="math inline">\(y \neq 0\)</span>. As such, if <span class="math inline">\(C A + A^T C\)</span>, then <span class="math inline">\(\frac{d V(x(t))}{dt} \leq 0\)</span>, i.e., will decrease in time (starting from any positive <span class="math inline">\(x(0)\)</span>) until the equilibrium <span class="math inline">\(x^\star\)</span> is reached.</p>
<p>The results above show that <strong>if <span class="math inline">\(A\)</span> is Lyapunov diagonally-stable and a feasible equilibrium <span class="math inline">\(x^\star\)</span> exists, then all trajectories starting at a positive density will converge to the equilibrium</strong>. This property is often used to prove <strong>global stability</strong>.</p>
</div>
</div>
<div id="what-makes-the-study-of-assembly-difficult" class="section level2">
<h2><span class="header-section-number">1.2</span> What makes the study of assembly difficult?</h2>
<p>There are three main complications that stand in the way of the development of simple theories for ecological assembly (taken from <span class="citation">Serván and Allesina (<a href="#ref-servan2020tractable" role="doc-biblioref">2020</a>)</span>):</p>
<ol style="list-style-type: decimal">
<li><p><strong>Invasion rates</strong>. We have a timescale for the local dynamics, and a timescale for invasions, and the time at which the first species goes extinct after an invasion influences the effect of subsequent invasions. The simplest way to think of this is to have a “rock-paper-scissors” community. Suppose that our island contains only “rock”, and that “paper” enters the system—if we wait for long enough, it will displace rock; if <em>before rock goes extinct</em>, “scissors” invades, we can recover the full three-species community; if instead scissors arrives when rock is extinct, then it will displace paper.</p>
<p>As such, if the speed at which the dynamics of the local community proceed are slow enough compared to the rate of invasion, we have that several species can invade before the community has reached its asymptotic configuration. At the extreme where local dynamics are fast compared to the rate of invasion, we have that each invader finds the local community at its asymptotic state; as the invasion rate increases, the system approaches a point where all the species enter the system before any extinction takes place. Increasing the invasion rate even further would result in an open system with constant immigration.</p></li>
<li><p><strong>Invasion size.</strong> Consider the two-species competitive Lotka-Volterra model with preemptive competition, and suppose that initially we have species <span class="math inline">\(x_1\)</span> resting at its carrying capacity, i.e., the state of the system is <span class="math inline">\(\{x_1\}\)</span>. If <span class="math inline">\(x_2\)</span> invades with sufficiently low density, we find <span class="math inline">\(\{x_1, x_2\} \to \{x_1\}\)</span>; on the other hand, if <span class="math inline">\(x_2\)</span> has sufficiently high density, we can cross the separatrix in the phase plane, leading to <span class="math inline">\(\{x_1, x_2\} \to \{x_2\}\)</span>. This simple example shows that the density at which the invader enters the system can alter the outcome of the dynamics.</p></li>
<li><p><strong>Invasion timing.</strong> When the local community coexists at a non-fixed point attractor, the fate of the invader could be very different depending on when it is introduced. For example, a predator requiring its prey to be above a certain level would not be able to invade an oscillating system whenever prey are at low abundance, but would start growing if the invasion happened at a time when prey were abundant.</p></li>
</ol>
</div>
<div id="ecological-assembly-without-tears" class="section level2">
<h2><span class="header-section-number">1.3</span> Ecological assembly without tears</h2>
<p>We make three main assumptions, which remove the difficulties above while leaving the model interesting to study:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Invasion events are rare.</strong> We assume that the invasion rate is low enough such that, after an invasion, the local community has sufficient time to reach its asymptotic configuration before the next invader arrives. In other words, we consider cases in which local dynamics operates at a much faster rate than invasions. Note that this choice precludes certain dynamics; for example, under these stringent conditions the rock-paper-scissors community described above would never reach the three-species configuration. While this is a strong requirement, it corresponds to assumptions routinely made in the study of population genetics, and in invasion analysis.</p></li>
<li><p><strong>Invaders arrive at low abundance.</strong> We assume that the density of the invader is low enough so that intraspecific effects are negligible at the time of invasion (again, as routinely assumed in invasion analysis). Under this assumption, the assembly of the Lotka-Volterra preemptive competition model would have two possible final states, corresponding to each species in isolation. Note also that whenever the invader can enter the system only at low abundance, the local stability of an attractor (i.e. the community at the attractor is resistant to small perturbations caused by changes in abundance of any of the species in the pool) is sufficient to make it a possible outcome of the assembly process.</p></li>
<li><p><strong>Fixed-point dynamics.</strong> Finally, we consider models in which the asymptotic state of the local community is a feasible, stable equilibrium, thereby sidestepping the difficulty stemming from the timing of invasion.</p>
<p>For example, the Generalized Lotka-Volterra model with a symmetric matrix of interaction <span class="math inline">\(A\)</span> yields only fixed-point dynamics.</p></li>
</ol>
</div>
<div id="top-down-and-bottom-up-assembly" class="section level2">
<h2><span class="header-section-number">1.4</span> Top-down and bottom-up assembly</h2>
<p>We distinguish between two extreme cases of assembly. In <strong>top-down</strong> assembly, all species enter the system (at arbitrary densities) <strong>at the same time</strong>; assembly then is simply the pruning of some of the species through the dynamics. At the other extreme, we find <strong>bottom-up assembly</strong>, in which species enter the system one at a time. Our second lecture will focus on top-down assembly, and the third on bottom-up assembly.</p>
</div>
<div id="modeling-invasions" class="section level2">
<h2><span class="header-section-number">1.5</span> Modeling invasions</h2>
<p>Imagine starting with a bare environment, and introducing the first species. If the species can grow in the new environment, it will establish, and if not, it will go extinct. Mathematically, we assume that <strong>new species are introduced at very low abundance</strong>, so that they do not experience self-limitation due to crowding, and that <strong>invasion are spaced in time</strong> so that the dynamics can play out before the next invasion happens. For example, consider the GLV model, and the case of the first species entering the system, and write the equation for the per-capita growth rate:</p>
<p><span class="math display">\[
\dfrac{1}{x_i(t)}\dfrac{dx_i(t)}{dt} = r_i + A_{ii} x_i(t)
\]</span></p>
<p>If <span class="math inline">\(x_i(0) \ll 1\)</span>, we can set <span class="math inline">\(A_{ii} x_i(0) \approx 0\)</span>, obtaining</p>
<p><span class="math display">\[
\dfrac{1}{x_i(t)}\dfrac{dx_i(t)}{dt} \approx r_i
\]</span></p>
<p>That is, the species will establish if it has a positive growth rate in the new environment. Suppose that this is the case: then species <span class="math inline">\(i\)</span> will grow to its equilibrium abundance <span class="math inline">\(x_i^\star = -r_i / A_{ii}\)</span>. Now add a second species. Its initial per-capita growth rate is going to be:</p>
<p><span class="math display">\[
\dfrac{1}{x_j(t)}\dfrac{dx_j(t)}{dt} = r_j + \sum_k A_{jk} x_k(t) \approx r_j + A_{ji}x_i^\star
\]</span></p>
<p>Species <span class="math inline">\(j\)</span> can therefore grow when rare if <span class="math inline">\(r_j + A_{ji}x_i^\star &gt; 0\)</span>, i.e., <span class="math inline">\(r_j &gt; -A_{ji}x_i^\star\)</span>. We call this type of inequality an <strong>“invasion criterion”</strong>.</p>
<p>If the species <span class="math inline">\(j\)</span> can grow when rare, in general, it could a) grow initially, but then go extinct; b) displace species <span class="math inline">\(i\)</span>, sending it to extinction; c) coexist with species <span class="math inline">\(i\)</span>. By reiterating invasions with different species, we can assemble a large ecological community.</p>
</div>
<div id="invasions-in-multispecies-communities" class="section level2">
<h2><span class="header-section-number">1.6</span> Invasions in multispecies communities</h2>
<p>Now consider a pool of species (e.g., a metacommunity/mainland) and an environment (e.g., a local habitat/island) in which some of the species are present, and coexisting at an equilibrium. We have <span class="math inline">\(n\)</span> species in the pool, and <span class="math inline">\(k\)</span> species in the habitat/island. We want to write conditions for the invasibility of the equilibrium. To this end, we can re-arrange the rows and columns of <span class="math inline">\(A\)</span>, and the elements of <span class="math inline">\(r\)</span> to obtain two blocks: one for the <span class="math inline">\(k\)</span> species already in the community, and one for the <span class="math inline">\(n-k\)</span> potential invaders.</p>
<p>The fixed point <span class="math inline">\(\bar{x}\)</span> can be written as:</p>
<p><span class="math display">\[
\bar{x} = \left(\begin{array}{l}
x^{(k)} \\
0^{(n-k)} 
\end{array} \right)
\]</span></p>
<p>where <span class="math inline">\(x^{(k)}\)</span> contains the density of the coexisting species. Similarly, the growth rates are</p>
<p><span class="math display">\[
r = \left(\begin{array}{l}
r^{(k)} \\
r^{(n-k)} 
\end{array} \right)
\]</span></p>
<p>and the interaction matrix</p>
<p><span class="math display">\[
A = \begin{pmatrix}
A^{(k,k)} &amp; A^{(k, n- k)}\\
A^{(n-k,k)} &amp; A^{(n-k, n- k)}\\
  \end{pmatrix}
\]</span></p>
<p>where each block <span class="math inline">\(A^{(a,b)}\)</span> contains the effects of the species in set <span class="math inline">\(b\)</span> on the growth of the species in <span class="math inline">\(a\)</span>. For feasibility we need:</p>
<p><span class="math display">\[
x^{(k)} = -\left(A^{(k,k)} \right)^{-1}r^{(k)} &gt; 0
\]</span></p>
<p>Now we want to write the condition for the <strong>non-invasibility</strong> of the resident community by the other species in the metacommunity. For each species in <span class="math inline">\((n-k)\)</span>, we need to have a negative growth rate when invading:</p>
<p><span class="math display">\[
r^{(n-k)} + A^{(n-k,k)}x^{(k)} &lt; 0
\]</span></p>
<p>an equilibrium <span class="math inline">\(\bar{x}\)</span> for which a) the <span class="math inline">\(x^{(k)}\)</span> is feasible and stable (when considering only the species in <span class="math inline">\(k\)</span>) and b) no other species can invade when rare is called the <strong>feasible, stable, non-invasible solution</strong> or the <strong>saturated equilibrium</strong>.</p>
</div>
<div id="lyapunov-stability-and-saturated-equilibria" class="section level2">
<h2><span class="header-section-number">1.7</span> Lyapunov stability and saturated equilibria</h2>
<p>We have seen in previous section that, whenever there exists a matrix <span class="math inline">\(C\)</span> such that <span class="math inline">\(CA + A^T C\)</span> is negative definite and we have a feasible equilibrium <span class="math inline">\(x^\star\)</span> then the equilibrium is globally stable. Now we consider the case in which a feasible equilibrium does not exist. However, we can prove that a <strong>saturated equilibrium</strong> exists and is unique: we have an equilibrium <span class="math inline">\(\bar{x}\)</span> in which some components are positive and some are zero such that <span class="math inline">\(k\)</span> species coexist at a globally stable equilibrium, and the remaining <span class="math inline">\((n-k)\)</span> species cannot invade it.</p>
<p>Following <span class="citation">Hofbauer and Sigmund (<a href="#ref-hofbauer1998evolutionary" role="doc-biblioref">1998</a>)</span> (section 15.3), we write:</p>
<p><span class="math display">\[
V(x) = -\sum_i c_i (\bar{x}_i \log x_i - x_i)
\]</span></p>
<p>yielding:</p>
<p><span class="math display">\[
\begin{aligned}
\dfrac{dV(x)}{dt} &amp;= -\sum_i c_i \left(\bar{x}_i \frac{d \log x_i}{dt} - \frac{d x_i}{dt} \right) \\
&amp;= -\sum_i c_i \left( \bar{x}_i - x_i \right)  \left( r_i + \sum_j A_{ij} x_j \right) \\
&amp;= -\sum_i c_i \left( \bar{x}_i - x_i \right)  \left( r_i + \sum_j A_{ij} (x_j - \bar{x}_j) +  \sum_j A_{ij} \bar{x}_j \right) \\
&amp;= \sum_{i,j} \left( \bar{x}_i - x_i \right) c_i A_{ij} \left( \bar{x}_j - x_j \right) + \sum_i c_i \left( \bar{x}_i - x_i \right) \left(r_i + \sum_j A_{ij} \bar{x}_j \right)
\end{aligned}
\]</span></p>
<p>The first term is negative for all <span class="math inline">\(x \neq \bar{x}\)</span>, and is zero at the saturated equilibrium point. The second term is zero for all <span class="math inline">\(\bar{x}_i &gt; 0\)</span>: <span class="math inline">\(r_i + \sum_j A_{ij} \bar{x}_j = 0\)</span>, given that <span class="math inline">\(\bar{x}\)</span> is an equilibrium for the species at positive density; for the remaining species (for which <span class="math inline">\(\bar{x}_i = 0\)</span>), this amounts to the invasion criterion above, and must therefore be negative. As such <span class="math inline">\(V(x)\)</span> is a Lyapunov function for the system, assuming negative values everywhere but at <span class="math inline">\(\bar{x}\)</span>.</p>

</div>
</div>
<h3> References and readings</h3>
<div id="refs" class="references">
<div id="ref-cadotte2016phylogenies">
<p>Cadotte, Marc W, and T Jonathan Davies. 2016. <em>Phylogenies in Ecology: A Guide to Concepts and Methods</em>. Princeton University Press.</p>
</div>
<div id="ref-diamond1975assembly">
<p>Diamond, Jared M. 1975. “Assembly of Species Communities.” <em>Ecology and Evolution of Communities</em>, 342–444.</p>
</div>
<div id="ref-drake1991community">
<p>Drake, James A. 1991. “Community-Assembly Mechanics and the Structure of an Experimental Species Ensemble.” <em>The American Naturalist</em> 137 (1): 1–26.</p>
</div>
<div id="ref-goh1977global">
<p>Goh, Bo S. 1977. “Global Stability in Many-Species Systems.” <em>The American Naturalist</em> 111 (977): 135–43.</p>
</div>
<div id="ref-gotelli1999communities">
<p>Gotelli, Nicholas J. 1999. “How Do Communities Come Together?” <em>Science</em> 286 (5445): 1684–5.</p>
</div>
<div id="ref-gotelli1996null">
<p>Gotelli, Nicholas J, and Gary R Graves. 1996. <em>Null Models in Ecology</em>.</p>
</div>
<div id="ref-hofbauer1998evolutionary">
<p>Hofbauer, Josef, and Karl Sigmund. 1998. <em>Evolutionary Games and Population Dynamics</em>. Cambridge University Press.</p>
</div>
<div id="ref-hubbell2001unified">
<p>Hubbell, Stephen P. 2001. <em>The Unified Neutral Theory of Biodiversity and Biogeography</em>. Vol. 32. Princeton University Press.</p>
</div>
<div id="ref-law1996permanence">
<p>Law, Richard, and R Daniel Morton. 1996. “Permanence and the Assembly of Ecological Communities.” <em>Ecology</em> 77 (3): 762–75.</p>
</div>
<div id="ref-morton1996models">
<p>Morton, R Daniel, Richard Law, Stuart L Pimm, and James A Drake. 1996. “On Models for Assembling Ecological Communities.” <em>Oikos</em>, 493–99.</p>
</div>
<div id="ref-servan2020tractable">
<p>Serván, Carlos A, and Stefano Allesina. 2020. “Tractable Models of Ecological Assembly.” <em>bioRxiv</em>.</p>
</div>
<div id="ref-weiher2001ecological">
<p>Weiher, Evan, and Paul Keddy. 2001. <em>Ecological Assembly Rules: Perspectives, Advances, Retreats</em>. Cambridge University Press.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="top-down-assembly.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ICTP_Winter_School.pdf", "ICTP_Winter_School.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
